<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    {%load static%}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration</title>
    <link rel="stylesheet" href="{% static 'css/registrations.css' %}">
    <link rel="stylesheet" href="{% static 'css/media.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body class="bg">

    <main class="d-flex justify-content-center align-items-center">
        <div class="container">
            <div class="d-flex  justify-content-center">
                <div class="form d-flex flex-column align-items-center justify-content-center">
                    <div class="d-flex justify-content-center flex-column align-items-end reg">
                        <div id="alert" className="alert alert-danger alert-dismissible fade show alt" role="alert">
                            <!-- <strong>Error : </strong> -->
                            <p id="txt"></p>
                        </div>
                        <h1><Span class="badge bg-secondary">Registration Form</Span></h1>
                    </div>
                    <!-- <form onsubmit="dataSubmit()"> -->
                    <form method="post">
                        {% csrf_token%}
                        <div class="mb-3">
                            <label for="name" class="form-label">Enter Name</label>
                            <input type="text" class="form-control" onkeyup="checkName()" id="name" name="name" required
                                aria-describedby="emailHelp" placeholde="alphabets only">
                        </div>
                        <div class="mb-3">
                            <label for="course" class="form-label">Enter Course</label>
                            <input type="text" class="form-control" onkeyup="checkCourse()" id="course" name="course"
                                required aria-describedby="emailHelp" placeholde="alphabets only">
                        </div>
                        <div class="mb-3">
                            <label for="phone" class="form-label">Enter Phone</label>
                            <input type="tel" class="form-control" onkeyup="checkPhone()" id="phone" name="phone"
                                required aria-describedby="emailHelp">
                        </div>
                        <div class="mb-3">
                            <label for="year" class="form-label">Enter Year</label>
                            <input type="tel" class="form-control" onkeyup="checkYear()" id="year" name="year" required
                                aria-describedby="emailHelp" maxlength="1">
                        </div>
                        <div class="mb-3">
                            <label for="collegeNme" class="form-label">Enter College Name</label>
                            <input type="text" class="form-control" id="collegeNme" name="collegeName" required
                                aria-describedby="emailHelp">
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Enter Email address</label>
                            <input type="email" class="form-control" placeholder="example@gmail.com"
                                onkeyup="checkEmail()" id="email" name="email" required aria-describedby="emailHelp">
                        </div>

                        <div class="d-flex justify-content-between">
                            <a class="btn btn-primary mx-3" href="{%url 'home'%}" role="button">&larr; Home</a>
                            <button disabled id="btn" type="submit" class="btn btn-primary mx-3"
                                onclick="checking()">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>
    <footer>

    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>

</body>
<script>
    document.getElementById("alert").style.display = 'none';
    let alert = document.getElementById("alert").style
    let btn = document.getElementById("btn")
    let error = document.getElementById("txt")
    var check = false;

    const checkName = () => {
        let name = document.getElementById("name").value
        let num = name.match(/[A-Za-z ]/gm)
        num === null ? num = 0 : num = name.match(/[A-Za-z ]/gm).length;
        if (num === name.length) {
            alert.display = 'none'
            btn.disabled = false;
            check = true;
        }
        else {
            alert.display = 'block'
            alert.color = 'red'
            error.innerText = 'Only Alphabets are allowed in Name'
            check = false;
            btn.disabled = true;
        }
    }
    const checkCourse = () => {
        let course = document.getElementById("course").value
        let num = course.match(/[A-Za-z ]/gm)
        num === null ? num = 0 : num = course.match(/[A-Za-z ]/gm).length;
        if (num === course.length) {
            alert.display = 'none'
            btn.disabled = false;
            check = true;
        }
        else {
            alert.display = 'block'
            alert.color = 'red'
            error.innerText = 'Only Alphabets are allowed in Course'
            check = false;
            btn.disabled = true;
        }
    }

    const checkYear = () => {
        let year = document.getElementById('year').value
        console.log(year.match(/[1-5]/g))
        if (year.match(/\d/g) === null) {
            alert.display = 'block'
            alert.color = 'red'
            error.innerText = "Only Integers are allowed"
            btn.disabled = true;
            check = false;
        }
        else {
            if (year.match(/[1-5]/g) === null) {
                alert.display = 'block'
                alert.color = 'red'
                error.innerText = "Enter a Valid Year"
                btn.disabled = true;
                check = false;
            }
            else {
                alert.display = 'none'
                btn.disabled = false;
                check = true;
            }
            // alert.display = 'none'
            // btn.disabled = false;
            // check = true;
        }
    }

    const checkEmail = () => {
        let email = document.getElementById("email").value
        if (email.endsWith('@gmail.com') === false) {
            alert.display = 'block'
            alert.color = 'red'
            error.innerText = "Only '@gmail.com' email adress are allowed"
            btn.disabled = true;
            check = false;
        }
        else {
            alert.display = 'none'
            btn.disabled = false;
            check = true;
        }
    }
    const checkPhone = () => {
        let phone = document.getElementById("phone").value
        if (phone.match(/\d/gm) === null) {
            if (phone !== '') {
                alert.display = 'block'
                alert.color = 'red'
                error.innerText = 'Only Phone Number are allowed'
                btn.disabled = true;
                check = false;
            }
        }
        else if (phone.match(/\d/gm).length !== phone.length) {
            console.log(phone.match(/\d/gm).length)
            alert.display = 'block'
            alert.color = 'red'
            error.innerText = 'Only Phone Number are allowed'
            btn.disabled = true;
            check = false;
        }
        else if (phone.length !== 10) {
            alert.display = 'block'
            alert.color = 'red'
            error.innerText = 'Phone is 10 digits required'
            btn.disabled = true;
            check = false;
        }
        else {
            alert.display = 'none'
            btn.disabled = false;
            check = true;
        }
    }

    const checking = () => {
        if (check) {
            checkName()
            if (check) {
                checkEmail()
                if (check) {
                    checkPhone()
                    if (check) {
                        checkYear()
                    }
                }
            }
        }
    }

    function sendMail() {
        const email = document.getElementById("usremail");
        Email.send({
            SecureToken: "a966b3a6-7ce4-4872-bc3e-367160a20fa1",
            To: document.getElementById("email").value,
            From: "tryst24kmv@gmail.com",
            Subject: "Confirmation Mail",
            Body: "<b> Thanks for contacting us, your query will be resolved within 24 hours </b>",
        })
    }

</script>

</html>